%--------------------------------------------------------------
% thesis.tex 
%--------------------------------------------------------------
% - template for the main file of Informatica@Unifi Thesis 
% - based on Classic Thesis Style Copyright (C) 2008 
%   Andr\'e Miede http://www.miede.de   
%--------------------------------------------------------------
\documentclass[openright,titlepage,oneside,fleqn,
	headinclude,12pt,a4paper,footinclude,makeidx]{scrbook}%twoside
%--------------------------------------------------------------
\usepackage[italian]{babel}
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc} 
\usepackage[square,numbers]{natbib} 
\usepackage[fleqn]{amsmath}
\usepackage{amssymb}
\usepackage{ellipsis}
\usepackage{listings}
\usepackage{subfig}
\usepackage[format=plain,labelformat=simple,labelsep=colon]{caption}
\usepackage{appendix}
\usepackage{siunitx}
\usepackage{lipsum}
\usepackage{dia-classicthesis-ldpkg}
\usepackage[eulerchapternumbers,linedheaders,subfig,beramono,eulermath,
parts,dottedtoc]{classicthesis}
\usepackage{imakeidx}
\usepackage{wrapfig}
\usepackage[italian,noabbrev]{cleveref}
%---------------------------------------------------------------
\newcommand{\myItalianTitle}{Attacchi side-channel ed esecuzione speculativa: analisi ed implementazione.\xspace}
\newcommand{\myEnglishTitle}{Side-channel attacks and speculative execution: analysis and implementation.\xspace}
\newcommand{\myDegree}{Corso di Laurea Magistrale in Informatica\xspace}
\newcommand{\myCurriculum}{Resilient and secure cyberphysical systems\xspace}
\newcommand{\myName}{Marco Buracchi\xspace}
\newcommand{\myProf}{Michele Boreale\xspace}
\newcommand{\myFaculty}{Scuola di Scienze Matematiche, Fisiche e Naturali\xspace}
\newcommand{\myUni}{\protect{Università degli Studi di Firenze}\xspace}
\newcommand{\myLocation}{Firenze\xspace}
\newcommand{\myTime}{Anno Accademico 2017-2018\xspace}
\newcommand{\mycopyright}{\includegraphics[width=1.5cm]{logo/cc.png} 
	\href{https://creativecommons.org/licenses/by-nc-sa/4.0/}{Creative
		Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)  }\xspace}

\newcommand{\disps}{dispositivo crittografico }
\newcommand{\dispp}{dispositivi crittografici }

\newcommand{\codice}[4]
	{\begin{center}
		\lstinputlisting[language={C},firstline={#1}, lastline={#2},caption={#3},label={#4}]{"D:/UNIFI/Magistrale/Tesi/spectre/primeProbe/spark.c"}
	\end{center}}
\newcommand{\codspark}[3]{
	\begin{center}
		\lstinputlisting[language={C},firstline={#1},lastline={#2},firstnumber={#1},caption={[#3]}]{code/spark.c}
	\end{center}}

\newcommand{\arr}[2]{$\text{\texttt{#1}}\left[ \text{\texttt{#2}}\right]$}
\newcommand{\arrdoppio}[3]{$\text{\texttt{#1}}\left[ \text{\texttt{#2}} \left[\text{\texttt{#3}}\right]\right]$}

\newcommand{\kilobyte}{kB}
\newcommand{\megabyte}{MB}
\newcommand{\gigahertz}{GHz}

\newcommand{\tcal}{\mathbb{T}}
\newcommand{\talfa}{\mathbb{T}_{\alpha}}
\newcommand{\tbeta}{\mathbb{T}_{\beta}}

\newcommand{\myfloatalign}{\centering} 

\renewcommand{\lstlistingname}{Codice}% Listing -> Codice
%--------------------------------------------------------------
\newlength{\abcd} % for ab..z string length calculation
% how all the floats will be aligned
\setlength{\extrarowheight}{3pt} % increase table row height
\captionsetup{format=hang,font=small}
%--------------------------------------------------------------
% Layout setting
%--------------------------------------------------------------
\graphicspath{{img/}}
\usepackage{geometry}
\geometry{
	a4paper,
	ignoremp,
	bindingoffset = 1cm, 
	textwidth     = 13.5cm,
	textheight    = 21.5cm,
	lmargin       = 3.5cm, % left margin
	tmargin       = 4cm    % top margin 
}

\crefname{listing}{codice}{codici}

\lstset{ %
	basicstyle=\small\ttfamily, 		% the size of the fonts that are used for the code
	breaklines=true,                	% sets automatic line breaking
	captionpos=b,                   	% sets the caption-position to bottom
	commentstyle=\color{violet},   		% comment style
	frame=none,							% adds a frame around the code
	frameround=fttt,					% round corner (use f instead t to edge corner)
	keepspaces=true,                	% keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
	keywordstyle=\color{blue},      	% keyword style
	language=C,               			% the language of the code
	numbers=left,                   	% where to put the line-numbers; possible values are (none, left, right)
	numbersep=5pt,                  	% how far the line-numbers are from the code
	numberstyle=\scriptsize\color{black}, % the style that is used for the line-numbers
	stepnumber=1,                   	% the step between two line-numbers. If it's 1, each line will be numbered
	stringstyle=\color{Brown},  		% string literal style
	tabsize=2                   		% sets default tabsize to 2 spaces
}

\makeindex[intoc]

%---------------------PARAMETERS-------------------------------
\begin{document}
\frenchspacing
\raggedbottom
\pagenumbering{roman}
\pagestyle{plain}

%---------------------FRONTMATTER------------------------------

\include{titlePage}
\pagestyle{scrheadings}

%---------------------MAINMATTER-------------------------------

\pagenumbering{arabic}
\tableofcontents
\listoffigures
\lstlistoflistings

\begingroup
\let\clearpage\relax
\let\cleardoublepage\relax
\let\cleardoublepage\relax

\vspace*{8ex}

\listoftables
\endgroup 

\cleardoublepage
\thispagestyle{empty}

\begin{flushright}
\null\vspace{\stretch {1}}
\emph{"From camp to camp, through the foul womb of night,\\The hum of either army stilly sounds,\\That the fixed sentinels almost receive\\The secret whispers of each other’s watch."\\} 
\null\vspace{5mm}
\emph{"Da campo a campo, nel tetro grembo della notte,\\s’avverte appena il brusio di entrambe le armate,\\sicché le sentinelle appostate quasi possono udire\\i mormorii furtivi delle sentinelle nemiche" \break --- Enrico V, William Shakespear} \vspace{\stretch{2}}\null
\end{flushright}
\cleardoublepage

%-----------------CAPITOLI-------------------------------------

\include{chapters/intro}
\include{chapters/sideChannels}
\include{chapters/timing}
\include{chapters/cache}
\include{chapters/spectre}
\include{chapters/spark}
\include{chapters/conclusioni}

%-----------------APPENDICI------------------------------------

\appendix
\include{chapters/appendiceA}
\include{chapters/appendiceB}

%-----------------BIBLIOGRAFIA---------------------------------

\bibliography{bib/bibliografia}
\bibliographystyle{unsrt}

%-----------------INDICI---------------------------------------

\include{chapters/acro}
\printindex
\end{document}